{
  "$schema": "https://vega.github.io/schema/vega/v5.json",
  "width": 1200,
  "height": 600,
  "background": "black",
  "data": [
    {
      "name": "source",
      "values": [],
      "transform": [
        {"type": "sequence", "start": 1, "stop": 500, "step": 20, "as": "id"},
        {"type": "formula", "as": "hue", "expr": "floor(random()*(360+1))"},
        {"type": "formula", "as": "explosion", "expr": "sequence(1,100,1)"},
        {
          "type": "formula",
          "as": "x",
          "expr": "domain('xscale')[0]+random() * (domain('xscale')[1]-domain('xscale')[0]+1)"
        },
        {"type": "flatten", "fields": ["explosion"]},
        {"type": "formula", "as": "accy", "expr": "(counter-counter)+gravity"},
        {
          "type": "formula",
          "as": "vely",
          "expr": "datum.vely==null?(random()*3.5)+3:counter > datum.id?datum.vely+datum.accy:(random()*3.5)+3"
        },
        {
          "type": "formula",
          "as": "y",
          "expr": "datum.y==null?0:counter > datum.id && datum.vely>0?datum.y+datum.vely:0"
        },
        {
          "type": "window",
          "sort": {"field": "explosion", "order": "ascending"},
          "ops": ["first_value", "first_value", "first_value"],
          "fields": ["x", "y", "vely"],
          "groupby": ["id"],
          "as": ["seedx", "seedy", "seedvely"]
        },
        {
          "type": "formula",
          "as": "lifespan",
          "expr": "datum.seedvely>0?1:  datum.lifespan-0.02+(counter-counter)"
        },
        {"type": "formula", "as": "accxExp", "expr": "0"},
        {
          "type": "formula",
          "as": "accyExp",
          "expr": "(counter-counter)+gravity/3"
        },
        {"type": "formula", "as": "angleExp", "expr": "random()*(2*PI-0+1)"},
        {
          "type": "formula",
          "as": "velxExp",
          "expr": "datum.seedvely>0?(random()*2-1)*cos(datum.angleExp):datum.velxExp+datum.accxExp"
        },
        {
          "type": "formula",
          "as": "velyExp",
          "expr": "datum.seedvely>0?(random()*2-1)*sin(datum.angleExp):datum.velyExp+datum.accyExp"
        },
        {
          "type": "formula",
          "as": "xExp",
          "expr": "datum.seedvely>0? datum.seedx: datum.xExp+datum.velxExp"
        },
        {
          "type": "formula",
          "as": "yExp",
          "expr": "datum.seedvely>0? datum.seedy: datum.yExp+datum.velyExp"
        },
        {"type": "filter", "expr": "counter > datum.id && datum.yExp > 0"}
      ]
    },
    {
      "name": "stars",
      "values": [],
      "transform": [
        {"type": "sequence", "start": 1, "stop": 100, "step": 1, "as": "id"},
        {
          "type": "formula",
          "as": "x",
          "expr": "domain('xscale')[0]+random() * (domain('xscale')[1]-domain('xscale')[0]+1)"
        },
        {
          "type": "formula",
          "as": "y",
          "expr": "domain('yscale')[0]+random() * (domain('yscale')[1]-domain('yscale')[0]+1)"
        },
        {"type": "formula", "as": "opacity", "expr": "random()"}
      ]
    }
  ],
  "signals": [
    {
      "name": "run",
      "value": false,
      "on": [{"events": "click", "update": "!run"}]
    },
    {"name": "gravity", "value": -0.2},
    {
      "name": "counter",
      "value": 1,
      "on": [
        {
          "events": {"type": "timer", "throttle": 20},
          "update": "run&&counter<550?counter +1 :0"
        },
        {"events": {"type": "dblclick"}, "update": "0"}
      ]
    },
    {
      "name": "building",
      "value": "M41.667,442.733c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533 v-17.067C50.2,446.147,46.787,442.733,41.667,442.733z M41.667,391.533c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533 v-17.067C50.2,394.947,46.787,391.533,41.667,391.533z M41.667,340.333c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533 v-17.067C50.2,343.747,46.787,340.333,41.667,340.333z M41.667,289.133c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533 v-17.067C50.2,292.547,46.787,289.133,41.667,289.133z M41.667,237.933c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533 v-17.067C50.2,241.347,46.787,237.933,41.667,237.933z M41.667,186.733c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533 v-17.067C50.2,190.147,46.787,186.733,41.667,186.733z M84.333,186.733c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 v-17.067C92.867,190.147,89.453,186.733,84.333,186.733z M84.333,391.533c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 v-17.067C92.867,394.947,89.453,391.533,84.333,391.533z M84.333,442.733c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 v-17.067C92.867,446.147,89.453,442.733,84.333,442.733z M84.333,289.133c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 v-17.067C92.867,292.547,89.453,289.133,84.333,289.133z M84.333,340.333c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 v-17.067C92.867,343.747,89.453,340.333,84.333,340.333z M84.333,237.933c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 v-17.067C92.867,241.347,89.453,237.933,84.333,237.933z M152.6,195.267c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 V203.8C161.133,198.68,157.72,195.267,152.6,195.267z M152.6,144.067c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 V152.6C161.133,147.48,157.72,144.067,152.6,144.067z M152.6,92.867c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 V101.4C161.133,96.28,157.72,92.867,152.6,92.867z M152.6,451.267c-5.12,0-8.533,3.413-8.533,8.533v8.533c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 V459.8C161.133,454.68,157.72,451.267,152.6,451.267z M152.6,348.867c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 V357.4C161.133,352.28,157.72,348.867,152.6,348.867z M152.6,246.467c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 V255C161.133,249.88,157.72,246.467,152.6,246.467z M152.6,400.067c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 V408.6C161.133,403.48,157.72,400.067,152.6,400.067z M152.6,297.667c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533c5.12,0,8.533-3.413,8.533-8.533 V306.2C161.133,301.08,157.72,297.667,152.6,297.667z M186.733,195.267c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V203.8 C195.267,198.68,191.853,195.267,186.733,195.267z M186.733,246.467c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V255 C195.267,249.88,191.853,246.467,186.733,246.467z M186.733,144.067c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V152.6 C195.267,147.48,191.853,144.067,186.733,144.067z M186.733,297.667c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V306.2 C195.267,301.08,191.853,297.667,186.733,297.667z M186.733,400.067c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V408.6 C195.267,403.48,191.853,400.067,186.733,400.067z M186.733,348.867c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V357.4 C195.267,352.28,191.853,348.867,186.733,348.867z M186.733,451.267c-5.12,0-8.533,3.413-8.533,8.533v8.533c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V459.8 C195.267,454.68,191.853,451.267,186.733,451.267z M186.733,92.867c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V101.4 C195.267,96.28,191.853,92.867,186.733,92.867z M220.867,297.667c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V306.2 C229.4,301.08,225.987,297.667,220.867,297.667z M220.867,348.867c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V357.4 C229.4,352.28,225.987,348.867,220.867,348.867z M220.867,400.067c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V408.6 C229.4,403.48,225.987,400.067,220.867,400.067z M220.867,451.267c-5.12,0-8.533,3.413-8.533,8.533v8.533c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V459.8 C229.4,454.68,225.987,451.267,220.867,451.267z M220.867,246.467c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V255 C229.4,249.88,225.987,246.467,220.867,246.467z M220.867,144.067c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V152.6 C229.4,147.48,225.987,144.067,220.867,144.067z M220.867,92.867c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V101.4 C229.4,96.28,225.987,92.867,220.867,92.867z M220.867,195.267c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V203.8 C229.4,198.68,225.987,195.267,220.867,195.267z M289.133,178.2c-5.12,0-8.533,3.413-8.533,8.533V203.8c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C297.667,181.613,294.253,178.2,289.133,178.2z M289.133,229.4c-5.12,0-8.533,3.413-8.533,8.533V255c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C297.667,232.813,294.253,229.4,289.133,229.4z M289.133,280.6c-5.12,0-8.533,3.413-8.533,8.533V306.2c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C297.667,284.013,294.253,280.6,289.133,280.6z M289.133,434.2c-5.12,0-8.533,3.413-8.533,8.533V459.8c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C297.667,437.613,294.253,434.2,289.133,434.2z M289.133,331.8c-5.12,0-8.533,3.413-8.533,8.533V357.4c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C297.667,335.213,294.253,331.8,289.133,331.8z M289.133,383c-5.12,0-8.533,3.413-8.533,8.533V408.6c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C297.667,386.413,294.253,383,289.133,383z M323.267,229.4c-5.12,0-8.533,3.413-8.533,8.533V255c0,5.12,3.413,8.533,8.533,8.533S331.8,260.12,331.8,255v-17.067 C331.8,232.813,328.387,229.4,323.267,229.4z M323.267,178.2c-5.12,0-8.533,3.413-8.533,8.533V203.8c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C331.8,181.613,328.387,178.2,323.267,178.2z M323.267,280.6c-5.12,0-8.533,3.413-8.533,8.533V306.2c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C331.8,284.013,328.387,280.6,323.267,280.6z M323.267,331.8c-5.12,0-8.533,3.413-8.533,8.533V357.4c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C331.8,335.213,328.387,331.8,323.267,331.8z M323.267,434.2c-5.12,0-8.533,3.413-8.533,8.533V459.8c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C331.8,437.613,328.387,434.2,323.267,434.2z M323.267,383c-5.12,0-8.533,3.413-8.533,8.533V408.6c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C331.8,386.413,328.387,383,323.267,383z M357.4,280.6c-5.12,0-8.533,3.413-8.533,8.533V306.2c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C365.933,284.013,362.52,280.6,357.4,280.6z M357.4,229.4c-5.12,0-8.533,3.413-8.533,8.533V255c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C365.933,232.813,362.52,229.4,357.4,229.4z M357.4,178.2c-5.12,0-8.533,3.413-8.533,8.533V203.8c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C365.933,181.613,362.52,178.2,357.4,178.2z M357.4,383c-5.12,0-8.533,3.413-8.533,8.533V408.6c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C365.933,386.413,362.52,383,357.4,383z M357.4,331.8c-5.12,0-8.533,3.413-8.533,8.533V357.4c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C365.933,335.213,362.52,331.8,357.4,331.8z M357.4,434.2c-5.12,0-8.533,3.413-8.533,8.533V459.8c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533v-17.067 C365.933,437.613,362.52,434.2,357.4,434.2z M425.667,246.467c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V255 C434.2,249.88,430.787,246.467,425.667,246.467z M425.667,195.267c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V203.8 C434.2,198.68,430.787,195.267,425.667,195.267z M425.667,144.067c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V152.6 C434.2,147.48,430.787,144.067,425.667,144.067z M425.667,451.267c-5.12,0-8.533,3.413-8.533,8.533v8.533c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V459.8 C434.2,454.68,430.787,451.267,425.667,451.267z M425.667,400.067c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V408.6 C434.2,403.48,430.787,400.067,425.667,400.067z M425.667,348.867c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V357.4 C434.2,352.28,430.787,348.867,425.667,348.867z M425.667,297.667c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V306.2 C434.2,301.08,430.787,297.667,425.667,297.667z M468.333,246.467c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V255 C476.867,249.88,473.453,246.467,468.333,246.467z M468.333,297.667c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V306.2 C476.867,301.08,473.453,297.667,468.333,297.667z M468.333,195.267c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V203.8 C476.867,198.68,473.453,195.267,468.333,195.267z M468.333,144.067c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V152.6 C476.867,147.48,473.453,144.067,468.333,144.067z M468.333,451.267c-5.12,0-8.533,3.413-8.533,8.533v8.533c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V459.8 C476.867,454.68,473.453,451.267,468.333,451.267z M468.333,348.867c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V357.4 C476.867,352.28,473.453,348.867,468.333,348.867z M468.333,400.067c-5.12,0-8.533,3.413-8.533,8.533v17.067c0,5.12,3.413,8.533,8.533,8.533s8.533-3.413,8.533-8.533V408.6 C476.867,403.48,473.453,400.067,468.333,400.067z M502.467,109.933H485.4v-25.6c0-5.12-3.413-8.533-8.533-8.533h-8.533V50.2c0-5.12-3.413-8.533-8.533-8.533 c-5.12,0-8.533,3.413-8.533,8.533v25.6h-8.533V50.2c0-5.12-3.413-8.533-8.533-8.533s-8.533,3.413-8.533,8.533v25.6h-8.533 c-5.12,0-8.533,3.413-8.533,8.533v25.6h-17.067c-5.12,0-8.533,3.413-8.533,8.533v25.6h-17.067v-25.6 c0-5.12-3.413-8.533-8.533-8.533h-25.6v-25.6c0-5.12-3.413-8.533-8.533-8.533s-8.533,3.413-8.533,8.533v25.6h-25.6 c-5.12,0-8.533,3.413-8.533,8.533v25.6h-17.067v-76.8c0-5.12-3.413-8.533-8.533-8.533h-25.6v-25.6 c0-5.12-3.413-8.533-8.533-8.533h-25.6V7.533c0-5.12-3.413-8.533-8.533-8.533S178.2,2.413,178.2,7.533V24.6h-25.6 c-5.12,0-8.533,3.413-8.533,8.533v25.6h-25.6c-5.12,0-8.533,3.413-8.533,8.533V152.6H101.4V127c0-5.12-3.413-8.533-8.533-8.533 h-8.533v-25.6c0-5.12-3.413-8.533-8.533-8.533s-8.533,3.413-8.533,8.533v25.6h-8.533v-25.6c0-5.12-3.413-8.533-8.533-8.533 s-8.533,3.413-8.533,8.533v25.6h-8.533c-5.12,0-8.533,3.413-8.533,8.533v25.6H7.533c-5.12,0-8.533,3.413-8.533,8.533v341.333 c0,5.12,3.413,8.533,8.533,8.533h110.933H255h136.533h110.933c5.12,0,8.533-3.413,8.533-8.533v-384 C511,113.347,507.587,109.933,502.467,109.933z M425.667,92.867h42.667v17.067h-42.667V92.867z M297.667,127h51.2v17.067h-51.2 V127z M161.133,41.667h51.2v17.067h-51.2V41.667z M41.667,135.533h42.667V152.6H41.667V135.533z M16.067,169.667h17.067h59.733 h17.067v324.267H16.067V169.667z M127,161.133V75.8h25.6h68.267h25.6v76.8v341.333H127V161.133z M263.533,161.133h25.6H357.4H383 v332.8H263.533V161.133z M493.933,493.933h-93.867V152.6V127h17.067h59.733h17.067V493.933z "
    }
  ],
  "scales": [
    {
      "name": "xscale",
      "type": "linear",
      "domain": {"signal": "[-100,100]"},
      "range": "width"
    },
    {
      "name": "yscale",
      "type": "linear",
      "domain": {"signal": "[0,100]"},
      "range": "height"
    },
    {
      "name": "size",
      "type": "linear",
      "round": true,
      "nice": false,
      "zero": true,
      "domain": [0, 200],
      "range": [100, 0]
    }
  ],
  "marks": [
    {
      "name": "starrynight",
      "type": "symbol",
      "from": {"data": "stars"},
      "encode": {
        "update": {
          "x": {"field": "x", "scale": "xscale"},
          "y": {"field": "y", "scale": "yscale"},
          "size": {"value": 10},
          "shape": {"value": "circle"},
          "fill": {"value": "white"},
          "opacity": {"field": "opacity"}
        }
      }
    },
    {
      "name": "moon",
      "type": "symbol",
      "data": [{}],
      "encode": {
        "update": {
          "x": {"value": 90, "scale": "xscale"},
          "y": {"value": 80, "scale": "yscale"},
          "size": {"value": 6000},
          "shape": {"value": "circle"},
          "fill": {"value": "white"},
          "opacity": {"value": 0.6}
        }
      }
    },
    {
      "name": "firework",
      "type": "symbol",
      "from": {"data": "source"},
      "encode": {
        "update": {
          "x": {"field": "x", "scale": "xscale"},
          "y": {"field": "y", "scale": "yscale"},
          "size": [
            {"test": "datum.explosion ==1 && datum.seedvely>0", "value": 20},
            {"value": 0}
          ],
          "shape": {"value": "circle"},
          "fill": {
            "color": {
              "h": {"field": "hue"},
              "s": {"value": 1},
              "l": {"value": 0.5}
            }
          },
          "tooltip": {"signal": "datum"}
        }
      }
    },
    {
      "name": "explosions",
      "type": "symbol",
      "from": {"data": "source"},
      "encode": {
        "update": {
          "x": {"field": "xExp", "scale": "xscale"},
          "y": {"field": "yExp", "scale": "yscale"},
          "size": {"value": 20},
          "shape": {"value": "circle"},
          "fill": {
            "color": {
              "h": {"field": "hue"},
              "s": {"value": 1},
              "l": {"value": 0.5}
            }
          },
          "opacity": {"field": "lifespan"},
          "tooltip": {"signal": "datum"}
        }
      }
    },
    {
      "type": "path",
      "encode": {
        "enter": {"fill": {"value": "white"}, "stroke": {"value": "black"}},
        "update": {
          "x": {"value": 125},
          "y": {"signal": "height"},
          "strokeWidth": {"value": 2},
          "scaleX": {"value": 0.25},
          "scaleY": {"value": 0.25},
          "path": {"signal": "building"}
        }
      }
    },
    {
      "type": "path",
      "encode": {
        "enter": {"fill": {"value": "white"}, "stroke": {"value": "black"}},
        "update": {
          "x": {"value": 250},
          "y": {"signal": "height"},
          "strokeWidth": {"value": 2},
          "scaleX": {"value": 0.25},
          "scaleY": {"value": 0.25},
          "path": {"signal": "building"}
        }
      }
    },
    {
      "type": "path",
      "encode": {
        "enter": {"fill": {"value": "white"}, "stroke": {"value": "black"}},
        "update": {
          "x": {"value": 375},
          "y": {"signal": "height"},
          "strokeWidth": {"value": 2},
          "scaleX": {"value": 0.25},
          "scaleY": {"value": 0.25},
          "path": {"signal": "building"}
        }
      }
    },
    {
      "type": "path",
      "encode": {
        "enter": {"fill": {"value": "white"}, "stroke": {"value": "black"}},
        "update": {
          "x": {"value": 0},
          "y": {"signal": "height"},
          "strokeWidth": {"value": 2},
          "scaleX": {"value": 0.25},
          "scaleY": {"value": 0.25},
          "path": {"signal": "building"}
        }
      }
    },
    {
      "type": "path",
      "encode": {
        "enter": {"fill": {"value": "white"}, "stroke": {"value": "black"}},
        "update": {
          "x": {"value": 500},
          "y": {"signal": "height"},
          "strokeWidth": {"value": 2},
          "scaleX": {"value": 0.25},
          "scaleY": {"value": 0.25},
          "path": {"signal": "building"}
        }
      }
    },
    {
      "type": "path",
      "encode": {
        "enter": {"fill": {"value": "white"}, "stroke": {"value": "black"}},
        "update": {
          "x": {"value": 625},
          "y": {"signal": "height"},
          "strokeWidth": {"value": 2},
          "scaleX": {"value": 0.25},
          "scaleY": {"value": 0.25},
          "path": {"signal": "building"}
        }
      }
    },
    {
      "type": "path",
      "encode": {
        "enter": {"fill": {"value": "white"}, "stroke": {"value": "black"}},
        "update": {
          "x": {"value": 750},
          "y": {"signal": "height"},
          "strokeWidth": {"value": 2},
          "scaleX": {"value": 0.25},
          "scaleY": {"value": 0.25},
          "path": {"signal": "building"}
        }
      }
    },
    {
      "type": "path",
      "encode": {
        "enter": {"fill": {"value": "white"}, "stroke": {"value": "black"}},
        "update": {
          "x": {"value": 875},
          "y": {"signal": "height"},
          "strokeWidth": {"value": 2},
          "scaleX": {"value": 0.25},
          "scaleY": {"value": 0.25},
          "path": {"signal": "building"}
        }
      }
    },
    {
      "type": "path",
      "encode": {
        "enter": {"fill": {"value": "white"}, "stroke": {"value": "black"}},
        "update": {
          "x": {"value": 1000},
          "y": {"signal": "height"},
          "strokeWidth": {"value": 2},
          "scaleX": {"value": 0.25},
          "scaleY": {"value": 0.25},
          "path": {"signal": "building"}
        }
      }
    },
    {
      "type": "path",
      "encode": {
        "enter": {"fill": {"value": "white"}, "stroke": {"value": "black"}},
        "update": {
          "x": {"value": 1125},
          "y": {"signal": "height"},
          "strokeWidth": {"value": 2},
          "scaleX": {"value": 0.25},
          "scaleY": {"value": 0.25},
          "path": {"signal": "building"}
        }
      }
    }
  ]
}